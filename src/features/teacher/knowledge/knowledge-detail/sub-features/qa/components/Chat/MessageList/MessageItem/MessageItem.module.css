/* [!file src/features/teacher/knowledge/knowledge-detail/sub-features/qa/components/Chat/MessageList/MessageItem/MessageItem.module.css] */

.messageItem {
    display: flex;
    gap: 16px;
    /* [!code focus start] */
    /* --- 核心修复：移除固定的 max-width，让其由子元素决定 --- */
    /* max-width: 85%; */ /* [!code --] */
    /* [!code focus end] */
    align-items: flex-start;
}

/* [!code focus start] */
/* --- 核心修复：用户消息整体靠右对齐 --- */
.messageItem.user {
    /* 使用 justify-content 实现靠右 */
    justify-content: flex-end;
}
/* [!code focus end] */

.avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    flex-shrink: 0;
    border: 2px solid var(--teacher-white);
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

.messageItem.assistant .avatar {
    background-color: #eef2ff;
    color: var(--teacher-primary);
}

.messageContent {
    /* [!code focus start] */
    /* --- 核心修复：为内容区域设置最大宽度和对齐 --- */
    max-width: 75%; /* 最大宽度为父容器的一半 */
    display: flex;
    flex-direction: column;
    /* [!code focus end] */
    min-width: 0;
}

/* [!code focus start] */
.messageItem.user .messageContent {
    align-items: flex-end; /* 让用户气泡在其容器内也靠右 */
}

.messageItem.assistant .messageContent {
    align-items: flex-start; /* 助手气泡靠左 */
}
/* [!code focus end] */


.messageBubble {
    padding: 12px 20px;
    border-radius: 12px;
    line-height: 1.7;
    /* [!code focus start] */
    /* --- 核心修复：让气泡宽度自适应内容 --- */
    display: inline-block; /* 关键！让DIV像行内元素一样包裹内容 */
    max-width: 100%;       /* 继承父容器（messageContent）的最大宽度限制 */
    text-align: left;      /* 确保多行文本是左对齐的 */
    /* [!code focus end] */
}

.messageItem.user .messageBubble {
    background: linear-gradient(135deg, var(--teacher-primary) 0%, #4166e2 100%);
    /* [!code focus start] */
    color: white; /* --- 核心修复：确保用户气泡内所有文本默认为白色 --- */
    /* [!code focus end] */
}

.messageItem.assistant .messageBubble {
    background-color: #f3f4f6;
    color: var(--teacher-text-primary);
    border: 1px solid #e5e7eb;
}

/* [!code focus start] */
/* --- 核心修复：为 MarkdownRenderer 传入的特定类名设置样式 --- */
.userMessageContent,
.userMessageContent p,
.userMessageContent code {
    color: white !important; /* 使用 !important 确保覆盖 MarkdownRenderer 的默认样式 */
}
/* [!code focus end] */



/* 闪烁光标，用于模拟打字效果 */
.blinkingCursor {
    display: inline-block;
    width: 8px;
    height: 1.2em;
    background-color: var(--teacher-text-primary);
    border-radius: 1px;
    animation: blink 1s step-end infinite;
    vertical-align: bottom;
    margin-left: 2px;
}

@keyframes blink {
    from, to { background-color: transparent; }
    50% { background-color: var(--teacher-text-primary); }
}

/* 思考过程面板 */
.thinkingPanel {
    margin-top: 12px;
    padding: 12px;
    background-color: rgba(243, 244, 246, 0.5);
    border-radius: 8px;
    border: 1px solid #e5e7eb;
}

.thinkingTitle {
    font-size: 13px;
    font-weight: 600;
    color: var(--teacher-text-secondary);
    margin: 0 0 8px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.thinkingTitle i {
    color: #9ca3af;
}

.thinkingContent {
    font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
    font-size: 12px;
    color: #4b5563;
    white-space: pre-wrap;
    word-break: break-word;
    margin: 0;
    padding: 0;
}

/* in src/features/teacher/knowledge/knowledge-detail/sub-features/qa/components/Chat/MessageList/MessageItem/MessageItem.module.css */
/* ... */
.messageItem.assistant .messageBubble {
    background-color: #f3f4f6;
    color: var(--teacher-text-primary);
    border: 1px solid #e5e7eb;
}

/* [!code focus start] */
/* 新增错误气泡的样式 */
.messageItem.assistant .messageBubble.error {
    background-color: #fef2f2; /* 浅红色 */
    border-color: #fecaca; /* 更深的红色边框 */
    color: #b91c1c; /* 深红色文字 */
}

/* 错误气泡内的代码块样式也应调整 */
.messageItem.assistant .messageBubble.error code {
    background-color: rgba(239, 68, 68, 0.1);
    color: #991b1b;
}
/* [!code focus end] */

/* ... */